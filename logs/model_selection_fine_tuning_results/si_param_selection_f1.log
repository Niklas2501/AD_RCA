
Dataset loaded:
Shape of training set (example, time, channels): (20812, 500, 61)
Shape of test set (example, time, channels): (3989, 500, 61)
Shape of train validation set (example, time, channels): (2313, 500, 61)
Shape of test validation set (example, time, channels): (1710, 500, 61)
Num of classes in all: 25

Adding feature wise convolutions with 32 filters per feature, 3 kernels and 1 strides ...
Adding feature wise convolutions with 1 filters per feature, 3 kernels and 1 strides ...
Adding feature based graph attention layer ...
Adding time based graph attention layer ...
Adding GRU layer with 256 units ...
Adding GRU layer with 61 units ...
Adding dense layer to forecasting model with 512 units and ReLu activation ...
Adding dense layer to forecasting model with 256 units and ReLu activation ...
Adding last dense layer to forecasting model with 61 units and sigmoid activation ...
Adding VAE as reconstruction model with dimensions 3072 & 1536 and ...
The RBM reconstructs the output of the gru layer.

Grid search running in SI / ST parameter selection mode.
Only the following hyperparameters will be evaluated:
relevance_mapping
unaffected_component_threshold
si_mode
si_parameter

WARNING: Does not check whether all other hyperparameters are set for the current model.
Crashes will likely be the result of this not been done after AD model selection grid search.

Generating percentiles file for this model ...
Saved percentiles file to ../data/trained_models/selected_2_mod_0/train_feature_percentiles.npy

Testing 49 combinations via grid search 
for model selected_2_mod_0 on the validation dataset. 


Best combinations tested:
                             relevance_mapping unaffected_compone..           si_mode si_parameter     AD F1     AD F2    AD TPR  AD Prec    AD ACC    AD TNR    AD FPR  SI/ST AVG-HR@100%  SI/ST AVG-HR@150%  SI/ST AVG-HR@K  SI/ST F1  SI/ST TPR  SI/ST Prec
Comb                                                                                                                                                                                                                                                          
48    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           97  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.477802           0.567978        0.304615  0.067375   0.070769    0.157293
0     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            1  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
1     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            3  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
2     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            5  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
3     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            7  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
4     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            9  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
5     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           11  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
6     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           13  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
7     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           15  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
8     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           17  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
9     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           19  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
10    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           21  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
11    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           23  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
12    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           25  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
13    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           27  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
14    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           29  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
15    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           31  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
16    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           33  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
17    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           35  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
18    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           37  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
19    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           39  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
20    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           41  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
21    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           43  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
22    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           45  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
23    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           47  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
24    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           49  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
25    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           51  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
26    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           53  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
27    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           55  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
28    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           57  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
29    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           59  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
30    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           61  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
31    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           63  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.331260           0.337341        0.304615  0.067375   0.070769    0.157293
47    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           95  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.310615           0.336051        0.304615  0.067375   0.070769    0.157293
32    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           65  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.309348           0.331421        0.304615  0.067375   0.070769    0.157293
33    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           67  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.307949           0.332300        0.304615  0.067375   0.070769    0.157293
34    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           69  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.307780           0.328081        0.304615  0.067375   0.070769    0.157293
37    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           75  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.302073           0.329963        0.304615  0.067375   0.070769    0.157293
38    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           77  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.301289           0.328681        0.304615  0.067375   0.070769    0.157293
36    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           73  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.300894           0.326527        0.304615  0.067375   0.070769    0.157293
35    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           71  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.300454           0.323128        0.304615  0.067375   0.070769    0.157293
39    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           79  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.300073           0.326850        0.304615  0.067375   0.070769    0.157293
41    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           83  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.295231           0.314315        0.304615  0.067375   0.070769    0.157293
40    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           81  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.294652           0.314916        0.304615  0.067375   0.070769    0.157293
46    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           93  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.293949           0.303429        0.304615  0.067375   0.070769    0.157293
45    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           91  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.292762           0.302352        0.304615  0.067375   0.070769    0.157293
42    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           85  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.292147           0.304242        0.304615  0.067375   0.070769    0.157293
43    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           87  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.291612           0.301399        0.304615  0.067375   0.070769    0.157293
44    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           89  0.705539  0.728477  0.744615  0.67036  0.881871  0.914079  0.085921           0.289355           0.299267        0.304615  0.067375   0.070769    0.157293

Full result output for the best combination:
                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR     Prec        F1        F2  AVG # affected
Component                                                                                                                                    
no_failure            1385    0  119  1266   0  0.914079       NaN  0.914079  0.085921       NaN  0.00000       NaN       NaN       41.571119
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      485.800000
txt15_i3                 5    1    0     0   4  0.200000  0.800000       NaN       NaN  0.200000  1.00000  0.333333  0.238095       73.800000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      397.333333
txt15_m1               160  159    0     0   1  0.993750  0.006250       NaN       NaN  0.993750  1.00000  0.996865  0.994994      417.150000
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      303.666667
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      293.500000
txt16_conveyor           8    1    0     0   7  0.125000  0.875000       NaN       NaN  0.125000  1.00000  0.222222  0.151515       68.250000
txt16_m3                65   45    0     0  20  0.692308  0.307692       NaN       NaN  0.692308  1.00000  0.818182  0.737705      295.953846
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        1.500000
txt17_i1                16    9    0     0   7  0.562500  0.437500       NaN       NaN  0.562500  1.00000  0.720000  0.616438      244.250000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.00000  0.068966  0.044248       13.250000
txt19_i4                 6    5    0     0   1  0.833333  0.166667       NaN       NaN  0.833333  1.00000  0.909091  0.862069      298.666667
combined              1710  242  119  1266  83  0.881871  0.255385  0.914079  0.085921  0.744615  0.67036  0.705539  0.728477       92.440936

                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR     Prec        F1        F2  AVG # affected
Component                                                                                                                                    
no_failure            1385    0  119  1266   0  0.914079       NaN  0.914079  0.085921       NaN  0.00000       NaN       NaN       41.571119
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      485.800000
txt15_i3                 5    1    0     0   4  0.200000  0.800000       NaN       NaN  0.200000  1.00000  0.333333  0.238095       73.800000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      397.333333
txt15_m1               160  159    0     0   1  0.993750  0.006250       NaN       NaN  0.993750  1.00000  0.996865  0.994994      417.150000
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      303.666667
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      293.500000
txt16_conveyor           8    1    0     0   7  0.125000  0.875000       NaN       NaN  0.125000  1.00000  0.222222  0.151515       68.250000
txt16_m3                65   45    0     0  20  0.692308  0.307692       NaN       NaN  0.692308  1.00000  0.818182  0.737705      295.953846
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        1.500000
txt17_i1                16    9    0     0   7  0.562500  0.437500       NaN       NaN  0.562500  1.00000  0.720000  0.616438      244.250000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.00000  0.068966  0.044248       13.250000
txt19_i4                 6    5    0     0   1  0.833333  0.166667       NaN       NaN  0.833333  1.00000  0.909091  0.862069      298.666667
combined              1710  242  119  1266  83  0.881871  0.255385  0.914079  0.085921  0.744615  0.67036  0.705539  0.728477       92.440936

                 #Examples  TP   FP    TN   FN        TPR       Prec         F1  AVG-HR@K  AVG-HR@100%  AVG-HR@150%
Component                                                                                                          
txt15_i1                 5   5  197   123    0          1  0.0247525  0.0483092  1.000000     0.500000     0.760000
txt15_i3                 5   1    0   320    4        0.2          1   0.333333  0.800000     0.000000     0.000000
txt15_conveyor           3   0   16   306    3          0          0        NaN  1.000000     0.611111     0.694444
txt15_m1               160   0    0   165  160          0        NaN        NaN  0.131250     0.671875     0.771250
txt15_pl                 9   1    1   315    8   0.111111        0.5   0.181818  0.777778     0.500000     0.500000
txt16_i3                 4   4    2   319    0          1   0.666667        0.8  1.000000     0.000000     0.000000
txt16_conveyor           8   0    1   316    8          0          0        NaN  0.125000     0.250000     0.750000
txt16_m3                65   0    0   260   65          0        NaN        NaN  0.000000     0.481319     0.594505
txt16_turntable          2   1   22   301    1        0.5  0.0434783       0.08  0.500000     0.000000     0.000000
txt17_i1                16   5    0   309   11     0.3125          1    0.47619  0.312500     0.000000     0.000000
txt17_pl                14   0   29   282   14          0          0        NaN  1.000000     0.000000     0.000000
txt18_pl                28   4    1   296   24   0.142857        0.8   0.242424  1.000000     0.202381     0.220238
txt19_i4                 6   2   33   286    4   0.333333  0.0571429   0.097561  1.000000     0.000000     0.000000
none                     0   0    0     0    0        NaN        NaN        NaN       NaN          NaN          NaN
combined               325  23  302  3598  302  0.0707692   0.157293   0.067375  0.304615     0.477802     0.567978

Execution time: 1022.9824778109323
