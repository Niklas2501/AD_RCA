
Dataset loaded:
Shape of training set (example, time, channels): (20812, 500, 61)
Shape of test set (example, time, channels): (3989, 500, 61)
Shape of train validation set (example, time, channels): (2313, 500, 61)
Shape of test validation set (example, time, channels): (1710, 500, 61)
Num of classes in all: 25

Adding feature wise convolutions with 32 filters per feature, 3 kernels and 1 strides ...
Adding feature wise convolutions with 1 filters per feature, 3 kernels and 1 strides ...
Adding feature based graph attention layer ...
Adding time based graph attention layer ...
Adding GRU layer with 256 units ...
Adding GRU layer with 61 units ...
Adding dense layer to forecasting model with 512 units and ReLu activation ...
Adding dense layer to forecasting model with 256 units and ReLu activation ...
Adding last dense layer to forecasting model with 61 units and sigmoid activation ...
Adding VAE as reconstruction model with dimensions 3072 & 1536 and ...
The RBM reconstructs the output of the gru layer.

Grid search running in SI / ST parameter selection mode.
Only the following hyperparameters will be evaluated:
relevance_mapping
unaffected_component_threshold
si_mode
si_parameter

WARNING: Does not check whether all other hyperparameters are set for the current model.
Crashes will likely be the result of this not been done after AD model selection grid search.

Generating percentiles file for this model ...
Saved percentiles file to ../data/trained_models/selected_2_mod_0/train_feature_percentiles.npy

Testing 49 combinations via grid search 
for model selected_2_mod_0 on the validation dataset. 


Best combinations tested:
                             relevance_mapping unaffected_compone..           si_mode si_parameter    AD F1     AD F2    AD TPR   AD Prec    AD ACC    AD TNR    AD FPR  SI/ST AVG-HR@100%  SI/ST AVG-HR@150%  SI/ST AVG-HR@K  SI/ST F1  SI/ST TPR  SI/ST Prec
Comb                                                                                                                                                                                                                                                          
48    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           97  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.466996           0.561875        0.292308  0.052774   0.058462    0.131589
34    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           69  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.321744           0.343363        0.292308  0.052774   0.058462    0.131589
0     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            1  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
1     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            3  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
2     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            5  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
3     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            7  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
4     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            9  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
5     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           11  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
6     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           13  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
7     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           15  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
8     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           17  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
9     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           19  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
10    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           21  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
11    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           23  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
12    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           25  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
13    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           27  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
14    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           29  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
15    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           31  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
16    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           33  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
17    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           35  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
18    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           37  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
19    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           39  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
20    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           41  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
21    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           43  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
22    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           45  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
23    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           47  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
24    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           49  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
25    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           51  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
26    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           53  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
27    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           55  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
28    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           57  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
29    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           59  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
30    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           61  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
31    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           63  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
32    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           65  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314601           0.321004        0.292308  0.052774   0.058462    0.131589
47    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           95  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.314168           0.338637        0.292308  0.052774   0.058462    0.131589
35    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           71  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.312989           0.338037        0.292308  0.052774   0.058462    0.131589
33    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           67  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.311136           0.343165        0.292308  0.052774   0.058462    0.131589
36    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           73  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.307531           0.331568        0.292308  0.052774   0.058462    0.131589
39    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           79  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.299788           0.328344        0.292308  0.052774   0.058462    0.131589
38    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           77  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.299392           0.325744        0.292308  0.052774   0.058462    0.131589
37    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           75  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.299304           0.325414        0.292308  0.052774   0.058462    0.131589
40    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           81  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.296777           0.326718        0.292308  0.052774   0.058462    0.131589
46    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           93  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.294923           0.307744        0.292308  0.052774   0.058462    0.131589
42    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           85  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.294747           0.311751        0.292308  0.052774   0.058462    0.131589
45    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           91  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.293993           0.305897        0.292308  0.052774   0.058462    0.131589
44    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           89  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.293758           0.306718        0.292308  0.052774   0.058462    0.131589
41    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           83  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.293524           0.314037        0.292308  0.052774   0.058462    0.131589
43    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           87  0.70901  0.726392  0.738462  0.681818  0.884795  0.919134  0.080866           0.290044           0.307355        0.292308  0.052774   0.058462    0.131589

Full result output for the best combination:
                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR      Prec        F1        F2  AVG # affected
Component                                                                                                                                     
no_failure            1385    0  112  1273   0  0.919134       NaN  0.919134  0.080866       NaN  0.000000       NaN       NaN       33.332130
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      482.600000
txt15_i3                 5    1    0     0   4  0.200000  0.800000       NaN       NaN  0.200000  1.000000  0.333333  0.238095       51.600000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      382.666667
txt15_m1               160  159    0     0   1  0.993750  0.006250       NaN       NaN  0.993750  1.000000  0.996865  0.994994      388.662500
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      247.777778
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      240.750000
txt16_conveyor           8    1    0     0   7  0.125000  0.875000       NaN       NaN  0.125000  1.000000  0.222222  0.151515       59.000000
txt16_m3                65   44    0     0  21  0.676923  0.323077       NaN       NaN  0.676923  1.000000  0.807339  0.723684      262.430769
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt17_i1                16    9    0     0   7  0.562500  0.437500       NaN       NaN  0.562500  1.000000  0.720000  0.616438      223.375000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.000000  0.068966  0.044248        7.928571
txt19_i4                 6    4    0     0   2  0.666667  0.333333       NaN       NaN  0.666667  1.000000  0.800000  0.714286      256.500000
combined              1710  240  112  1273  85  0.884795  0.261538  0.919134  0.080866  0.738462  0.681818  0.709010  0.726392       80.835088

                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR      Prec        F1        F2  AVG # affected
Component                                                                                                                                     
no_failure            1385    0  112  1273   0  0.919134       NaN  0.919134  0.080866       NaN  0.000000       NaN       NaN       33.332130
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      482.600000
txt15_i3                 5    1    0     0   4  0.200000  0.800000       NaN       NaN  0.200000  1.000000  0.333333  0.238095       51.600000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      382.666667
txt15_m1               160  159    0     0   1  0.993750  0.006250       NaN       NaN  0.993750  1.000000  0.996865  0.994994      388.662500
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      247.777778
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      240.750000
txt16_conveyor           8    1    0     0   7  0.125000  0.875000       NaN       NaN  0.125000  1.000000  0.222222  0.151515       59.000000
txt16_m3                65   44    0     0  21  0.676923  0.323077       NaN       NaN  0.676923  1.000000  0.807339  0.723684      262.430769
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt17_i1                16    9    0     0   7  0.562500  0.437500       NaN       NaN  0.562500  1.000000  0.720000  0.616438      223.375000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.000000  0.068966  0.044248        7.928571
txt19_i4                 6    4    0     0   2  0.666667  0.333333       NaN       NaN  0.666667  1.000000  0.800000  0.714286      256.500000
combined              1710  240  112  1273  85  0.884795  0.261538  0.919134  0.080866  0.738462  0.681818  0.709010  0.726392       80.835088

                 #Examples  TP   FP    TN   FN        TPR       Prec         F1  AVG-HR@K  AVG-HR@100%  AVG-HR@150%
Component                                                                                                          
txt15_i1                 5   5  192   128    0          1  0.0253807   0.049505  1.000000     0.520000     0.800000
txt15_i3                 5   0    0   320    5          0        NaN        NaN  0.400000     0.000000     0.000000
txt15_conveyor           3   0   19   303    3          0          0        NaN  1.000000     0.583333     0.666667
txt15_m1               160   0    0   165  160          0        NaN        NaN  0.125000     0.652500     0.764375
txt15_pl                 9   1    1   315    8   0.111111        0.5   0.181818  0.777778     0.500000     0.500000
txt16_i3                 4   4    1   320    0          1        0.8   0.888889  1.000000     0.000000     0.000000
txt16_conveyor           8   0    1   316    8          0          0        NaN  0.125000     0.250000     0.718750
txt16_m3                65   0    0   260   65          0        NaN        NaN  0.000000     0.474725     0.586813
txt16_turntable          2   0   22   301    2          0          0        NaN  0.000000     0.000000     0.000000
txt17_i1                16   5    0   309   11     0.3125          1    0.47619  0.312500     0.000000     0.000000
txt17_pl                14   0   27   284   14          0          0        NaN  1.000000     0.000000     0.000000
txt18_pl                28   2    1   296   26  0.0714286   0.666667   0.129032  1.000000     0.202381     0.211310
txt19_i4                 6   2   42   277    4   0.333333  0.0454545       0.08  1.000000     0.000000     0.000000
none                     0   0    0     0    0        NaN        NaN        NaN       NaN          NaN          NaN
combined               325  19  306  3594  306  0.0584615   0.131589  0.0527735  0.292308     0.466996     0.561875

Execution time: 1071.3154002840165
