
Dataset loaded:
Shape of training set (example, time, channels): (20812, 500, 61)
Shape of test set (example, time, channels): (3989, 500, 61)
Shape of train validation set (example, time, channels): (2313, 500, 61)
Shape of test validation set (example, time, channels): (1710, 500, 61)
Num of classes in all: 25

Adding feature wise convolutions with 32 filters per feature, 3 kernels and 1 strides ...
Adding feature wise convolutions with 1 filters per feature, 3 kernels and 1 strides ...
Adding feature based graph attention layer ...
Adding time based graph attention layer ...
Adding GRU layer with 256 units ...
Adding GRU layer with 61 units ...
Adding dense layer to forecasting model with 512 units and ReLu activation ...
Adding dense layer to forecasting model with 256 units and ReLu activation ...
Adding last dense layer to forecasting model with 61 units and sigmoid activation ...
Adding VAE as reconstruction model with dimensions 3072 & 1536 and ...
The RBM reconstructs the output of the gru layer.

Grid search running in SI / ST parameter selection mode.
Only the following hyperparameters will be evaluated:
relevance_mapping
unaffected_component_threshold
si_mode
si_parameter

WARNING: Does not check whether all other hyperparameters are set for the current model.
Crashes will likely be the result of this not been done after AD model selection grid search.

Generating percentiles file for this model ...
Saved percentiles file to ../data/trained_models/selected_2_mod_0/train_feature_percentiles.npy

Testing 49 combinations via grid search 
for model selected_2_mod_0 on the validation dataset. 


Best combinations tested:
                             relevance_mapping unaffected_compone..           si_mode si_parameter     AD F1     AD F2    AD TPR   AD Prec    AD ACC    AD TNR    AD FPR  SI/ST AVG-HR@100%  SI/ST AVG-HR@150%  SI/ST AVG-HR@K  SI/ST F1  SI/ST TPR  SI/ST Prec
Comb                                                                                                                                                                                                                                                           
48    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           97  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.483363           0.569018        0.310769  0.081349       0.08    0.175931
0     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            1  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
1     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            3  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
2     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            5  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
3     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            7  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
4     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile            9  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
5     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           11  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
6     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           13  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
7     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           15  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
8     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           17  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
9     {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           19  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
10    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           21  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
11    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           23  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
12    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           25  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
13    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           27  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
14    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           29  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
15    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           31  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
16    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           33  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
17    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           35  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
18    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           37  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
19    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           39  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
20    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           41  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
21    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           43  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
22    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           45  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
23    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           47  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
24    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           49  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
25    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           51  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
26    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           53  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
27    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           55  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
28    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           57  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.338256           0.343861        0.310769  0.081349       0.08    0.175931
29    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           59  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.320300           0.334278        0.310769  0.081349       0.08    0.175931
30    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           61  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.314513           0.334769        0.310769  0.081349       0.08    0.175931
32    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           65  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.314278           0.335011        0.310769  0.081349       0.08    0.175931
31    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           63  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.311802           0.331971        0.310769  0.081349       0.08    0.175931
47    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           95  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.308952           0.330103        0.310769  0.081349       0.08    0.175931
35    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           71  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.303194           0.326476        0.310769  0.081349       0.08    0.175931
36    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           73  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.302718           0.326359        0.310769  0.081349       0.08    0.175931
34    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           69  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.302103           0.325707        0.310769  0.081349       0.08    0.175931
37    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           75  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.302029           0.326542        0.310769  0.081349       0.08    0.175931
33    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           67  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.301209           0.323018        0.310769  0.081349       0.08    0.175931
39    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           79  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.298454           0.313172        0.310769  0.081349       0.08    0.175931
40    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           81  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.296300           0.307172        0.310769  0.081349       0.08    0.175931
43    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           87  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.295055           0.302586        0.310769  0.081349       0.08    0.175931
38    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           77  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.294542           0.314337        0.310769  0.081349       0.08    0.175931
41    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           83  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.294293           0.303333        0.310769  0.081349       0.08    0.175931
46    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           93  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.293949           0.302044        0.310769  0.081349       0.08    0.175931
44    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           89  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.292630           0.304637        0.310769  0.081349       0.08    0.175931
42    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           85  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.291392           0.301692        0.310769  0.081349       0.08    0.175931
45    {'h': 1.0, 'm': 0.0, 'l': 0.0, 'e': 0.0}                 None  jenks_percentile           91  0.669291  0.734024  0.784615  0.583524  0.852632  0.868592  0.131408           0.291311           0.303099        0.310769  0.081349       0.08    0.175931

Full result output for the best combination:
                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR      Prec        F1        F2  AVG # affected
Component                                                                                                                                     
no_failure            1385    0  182  1203   0  0.868592       NaN  0.868592  0.131408       NaN  0.000000       NaN       NaN       49.558845
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      488.200000
txt15_i3                 5    2    0     0   3  0.400000  0.600000       NaN       NaN  0.400000  1.000000  0.571429  0.454545       90.200000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      413.000000
txt15_m1               160  160    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      437.350000
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      340.222222
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      337.750000
txt16_conveyor           8    3    0     0   5  0.375000  0.625000       NaN       NaN  0.375000  1.000000  0.545455  0.428571       89.375000
txt16_m3                65   52    0     0  13  0.800000  0.200000       NaN       NaN  0.800000  1.000000  0.888889  0.833333      322.200000
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN       12.000000
txt17_i1                16   11    0     0   5  0.687500  0.312500       NaN       NaN  0.687500  1.000000  0.814815  0.733333      261.000000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.000000  0.068966  0.044248       18.321429
txt19_i4                 6    5    0     0   1  0.833333  0.166667       NaN       NaN  0.833333  1.000000  0.909091  0.862069      334.666667
combined              1710  255  182  1203  70  0.852632  0.215385  0.868592  0.131408  0.784615  0.583524  0.669291  0.734024      102.653801

                 #Examples   TP   FP    TN  FN       ACC       FNR       TNR       FPR       TPR      Prec        F1        F2  AVG # affected
Component                                                                                                                                     
no_failure            1385    0  182  1203   0  0.868592       NaN  0.868592  0.131408       NaN  0.000000       NaN       NaN       49.558845
txt15_i1                 5    5    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      488.200000
txt15_i3                 5    2    0     0   3  0.400000  0.600000       NaN       NaN  0.400000  1.000000  0.571429  0.454545       90.200000
txt15_conveyor           3    3    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      413.000000
txt15_m1               160  160    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      437.350000
txt15_pl                 9    9    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      340.222222
txt16_i3                 4    4    0     0   0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      337.750000
txt16_conveyor           8    3    0     0   5  0.375000  0.625000       NaN       NaN  0.375000  1.000000  0.545455  0.428571       89.375000
txt16_m3                65   52    0     0  13  0.800000  0.200000       NaN       NaN  0.800000  1.000000  0.888889  0.833333      322.200000
txt16_turntable          2    0    0     0   2  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN       12.000000
txt17_i1                16   11    0     0   5  0.687500  0.312500       NaN       NaN  0.687500  1.000000  0.814815  0.733333      261.000000
txt17_pl                14    0    0     0  14  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.000000
txt18_pl                28    1    0     0  27  0.035714  0.964286       NaN       NaN  0.035714  1.000000  0.068966  0.044248       18.321429
txt19_i4                 6    5    0     0   1  0.833333  0.166667       NaN       NaN  0.833333  1.000000  0.909091  0.862069      334.666667
combined              1710  255  182  1203  70  0.852632  0.215385  0.868592  0.131408  0.784615  0.583524  0.669291  0.734024      102.653801

                 #Examples  TP   FP    TN   FN       TPR       Prec         F1  AVG-HR@K  AVG-HR@100%  AVG-HR@150%
Component                                                                                                         
txt15_i1                 5   5  199   121    0         1  0.0245098  0.0478469  1.000000     0.500000     0.740000
txt15_i3                 5   2    0   320    3       0.4          1   0.571429  0.800000     0.000000     0.000000
txt15_conveyor           3   0   13   309    3         0          0        NaN  1.000000     0.611111     0.750000
txt15_m1               160   0    0   165  160         0        NaN        NaN  0.137500     0.682500     0.775625
txt15_pl                 9   2    1   315    7  0.222222   0.666667   0.333333  0.777778     0.500000     0.500000
txt16_i3                 4   4    1   320    0         1        0.8   0.888889  1.000000     0.000000     0.000000
txt16_conveyor           8   1    1   316    7     0.125        0.5        0.2  0.250000     0.281250     0.750000
txt16_m3                65   0    0   260   65         0        NaN        NaN  0.000000     0.479121     0.587912
txt16_turntable          2   1   24   299    1       0.5       0.04  0.0740741  0.500000     0.000000     0.000000
txt17_i1                16   5    0   309   11    0.3125          1    0.47619  0.312500     0.000000     0.000000
txt17_pl                14   0   29   282   14         0          0        NaN  1.000000     0.000000     0.000000
txt18_pl                28   4    1   296   24  0.142857        0.8   0.242424  1.000000     0.202381     0.220238
txt19_i4                 6   2   30   289    4  0.333333     0.0625   0.105263  1.000000     0.000000     0.000000
none                     0   0    0     0    0       NaN        NaN        NaN       NaN          NaN          NaN
combined               325  26  299  3601  299      0.08   0.175931  0.0813495  0.310769     0.483363     0.569018

Execution time: 1063.237327185925
