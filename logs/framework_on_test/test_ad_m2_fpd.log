
Dataset loaded:
Shape of training set (example, time, channels): (20812, 500, 61)
Shape of test set (example, time, channels): (3989, 500, 61)
Shape of train validation set (example, time, channels): (2313, 500, 61)
Shape of test validation set (example, time, channels): (1710, 500, 61)
Num of classes in all: 25

Adding feature wise convolutions with 32 filters per feature, 3 kernels and 1 strides ...
Adding feature wise convolutions with 1 filters per feature, 3 kernels and 1 strides ...
Adding feature based graph attention layer ...
Adding time based graph attention layer ...
Adding GRU layer with 256 units ...
Adding GRU layer with 61 units ...
Adding dense layer to forecasting model with 512 units and ReLu activation ...
Adding dense layer to forecasting model with 256 units and ReLu activation ...
Adding last dense layer to forecasting model with 61 units and sigmoid activation ...
Adding VAE as reconstruction model with dimensions 3072 & 1536 and ...
The RBM reconstructs the output of the gru layer.

Evaluating model selected_2_mod_0 on the test dataset. 

----------------------------------------------------------------------------------------------------------------------------------------------------------
Final Result for model selected_2_mod_0 :
----------------------------------------------------------------------------------------------------------------------------------------------------------
Metrics:
TPR = True Positive Rate/Recall
FPR = False Positive RateTNR = True Negative Rate/Specificity
FNR = False Negative Rate/Miss rate
Prec = Precision
ACC = Accuracy
----------------------------------------------------------------------------------------------------------------------------------------------------------
Anomaly detection results (based on INTERMEDIATE predictions): *1
----------------------------------------------------------------------------------------------------------------------------------------------------------
                 #Examples   TP   FP    TN   FN       ACC       FNR       TNR       FPR       TPR     Prec        F1        F2  AVG # affected
Component                                                                                                                                     
no_failure            3305    0  499  2806    0  0.849017       NaN  0.849017  0.150983       NaN  0.00000       NaN       NaN       53.496520
txt15_i1                19   19    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      481.789474
txt15_i3                 8    4    0     0    4  0.500000  0.500000       NaN       NaN  0.500000  1.00000  0.666667  0.555556      108.250000
txt15_conveyor           8    8    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      371.250000
txt15_m1               301  301    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      439.275748
txt15_pl                24   24    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.00000  1.000000  1.000000      335.291667
txt16_i3                 5    0    0     0    5  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN       97.400000
txt16_conveyor          39   11    0     0   28  0.282051  0.717949       NaN       NaN  0.282051  1.00000  0.440000  0.329341       90.615385
txt16_m3               141  126    0     0   15  0.893617  0.106383       NaN       NaN  0.893617  1.00000  0.943820  0.913043      364.489362
txt16_turntable         10    0    0     0   10  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        4.300000
txt17_i1                51   34    0     0   17  0.666667  0.333333       NaN       NaN  0.666667  1.00000  0.800000  0.714286      230.117647
txt17_pl                19    0    0     0   19  0.000000  1.000000       NaN       NaN  0.000000      NaN       NaN       NaN        0.210526
txt18_pl                48    5    0     0   43  0.104167  0.895833       NaN       NaN  0.104167  1.00000  0.188679  0.126904       34.541667
txt19_i4                11    5    0     0    6  0.454545  0.545455       NaN       NaN  0.454545  1.00000  0.625000  0.510204      181.454545
combined              3989  537  499  2806  147  0.838055  0.214912  0.849017  0.150983  0.785088  0.51834  0.624419  0.711824      100.505390
----------------------------------------------------------------------------------------------------------------------------------------------------------
Anomaly detection results (based on FINAL predictions): *1
----------------------------------------------------------------------------------------------------------------------------------------------------------
                 #Examples   TP   FP    TN   FN       ACC       FNR       TNR       FPR       TPR      Prec        F1        F2  AVG # affected
Component                                                                                                                                      
no_failure            3305    0  384  2921    0  0.883812       NaN  0.883812  0.116188       NaN  0.000000       NaN       NaN       53.496520
txt15_i1                19   19    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      481.789474
txt15_i3                 8    4    0     0    4  0.500000  0.500000       NaN       NaN  0.500000  1.000000  0.666667  0.555556      108.250000
txt15_conveyor           8    8    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      371.250000
txt15_m1               301  301    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      439.275748
txt15_pl                24   24    0     0    0  1.000000  0.000000       NaN       NaN  1.000000  1.000000  1.000000  1.000000      335.291667
txt16_i3                 5    0    0     0    5  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN       97.400000
txt16_conveyor          39    9    0     0   30  0.230769  0.769231       NaN       NaN  0.230769  1.000000  0.375000  0.272727       90.615385
txt16_m3               141  125    0     0   16  0.886525  0.113475       NaN       NaN  0.886525  1.000000  0.939850  0.907112      364.489362
txt16_turntable         10    0    0     0   10  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        4.300000
txt17_i1                51   33    0     0   18  0.647059  0.352941       NaN       NaN  0.647059  1.000000  0.785714  0.696203      230.117647
txt17_pl                19    0    0     0   19  0.000000  1.000000       NaN       NaN  0.000000       NaN       NaN       NaN        0.210526
txt18_pl                48    4    0     0   44  0.083333  0.916667       NaN       NaN  0.083333  1.000000  0.153846  0.102041       34.541667
txt19_i4                11    5    0     0    6  0.454545  0.545455       NaN       NaN  0.454545  1.000000  0.625000  0.510204      181.454545
combined              3989  532  384  2921  152  0.865630  0.222222  0.883812  0.116188  0.777778  0.580786  0.665000  0.728368      100.505390
----------------------------------------------------------------------------------------------------------------------------------------------------------
*1 Note that these tables do NOT have the semantics of a multi class confusion matrix. For each component a binary classification semantic 
(is anomaly or not) is displayed. i.e. there won't be any TP/FN for no_failure and no FP/TN for the individual components.
----------------------------------------------------------------------------------------------------------------------------------------------------------
Symptom identification and tracing results per component: *2
----------------------------------------------------------------------------------------------------------------------------------------------------------
                 #Examples  TP   FP    TN   FN        TPR       Prec         F1  AVG-HR@K  AVG-HR@100%  AVG-HR@150%
Component                                                                                                          
txt15_i1                19  19  408   257    0          1  0.0444965  0.0852018  1.000000     0.563158     0.610526
txt15_i3                 8   0    0   676    8          0        NaN        NaN  0.625000     0.000000     0.156250
txt15_conveyor           8   0   30   646    8          0          0        NaN  1.000000     0.270833     0.312500
txt15_m1               301   0    0   383  301          0        NaN        NaN  0.139535     0.379734     0.382724
txt15_pl                24   5    1   659   19   0.208333   0.833333   0.333333  0.958333     0.465278     0.479167
txt16_i3                 5   1    5   674    4        0.2   0.166667   0.181818  1.000000     0.400000     0.480000
txt16_conveyor          39   0    0   645   39          0        NaN        NaN  0.128205     0.243590     0.250000
txt16_m3               141   0    0   543  141          0        NaN        NaN  0.000000     0.339412     0.409828
txt16_turntable         10   2   34   640    8        0.2  0.0555556  0.0869565  0.200000     0.050000     0.350000
txt17_i1                51  11    0   633   40   0.215686          1   0.354839  0.294118     0.094118     0.200000
txt17_pl                19   1   81   584   18  0.0526316  0.0121951   0.019802  1.000000     0.157895     0.165414
txt18_pl                48  20    4   632   28   0.416667   0.833333   0.555556  0.958333     0.303819     0.508681
txt19_i4                11   4   53   620    7   0.363636  0.0701754   0.117647  1.000000     0.327273     0.345455
none                     0   0    5   679    0        NaN          0        NaN       NaN          NaN          NaN
combined               684  63  621  8271  621  0.0921053   0.167015  0.0845487  0.292398     0.327739     0.375797
----------------------------------------------------------------------------------------------------------------------------------------------------------
Symptom tracing reduced to work station granularity: *2
----------------------------------------------------------------------------------------------------------------------------------------------------------
           #Examples   TP   FP    TN   FN       TPR       Prec        F1
Component                                                               
none               0    0    5   679    0       NaN          0       NaN
txt15            360  352  111   213    8  0.977778   0.760259  0.855407
txt16            195   42    0   489  153  0.215385          1   0.35443
txt17             70   40   53   561   30  0.571429   0.430108  0.490798
txt18             48   20    4   632   28  0.416667   0.833333  0.555556
txt19             11    4   53   620    7  0.363636  0.0701754  0.117647
combined         684  458  226  3194  226  0.669591   0.788849  0.642364
----------------------------------------------------------------------------------------------------------------------------------------------------------
*2 Note that the metrics in the combined row are calculated as weighted average of the scores of the individual classes
based on the number of examples.
----------------------------------------------------------------------------------------------------------------------------------------------------------

Hyperparameter configuration used for this test:

{
    "time_series_length": 500,
    "time_series_depth": 61,
    "notes": "M_2,FPD",
    "variants": [
        "reconstruct_gru"
    ],
    "defined_variants": [
        "zhao",
        "reconstruct_gru",
        "gru_fbm",
        "gru_ae",
        "reconstruction_error"
    ],
    "batch_size": 128,
    "epochs": 5000,
    "learning_rate": 0.0001,
    "early_stopping_enabled": true,
    "early_stopping_limit": 15,
    "gradient_cap_enabled": true,
    "gradient_cap": 10,
    "gamma": 0.5,
    "conv_filters": [
        32,
        1
    ],
    "conv_kernel_size": [
        3,
        3
    ],
    "conv_strides": [
        1,
        1
    ],
    "d1_gru_units": [
        256,
        61
    ],
    "d2_fc_units": [
        512,
        256,
        61
    ],
    "d3_vae_latent_dim": 1536,
    "d3_vae_inter_dim": 3072,
    "sw_size_time_gat": 251,
    "single_timestamp_anomaly_threshold": 0.29,
    "affected_timestamps_threshold": 120,
    "unaffected_component_threshold": 0.45,
    "relevance_mapping": {
        "h": 1.0,
        "m": 0.0,
        "l": 0.0,
        "e": 0.0
    },
    "si_parameter": null,
    "si_mode": "sort_only"
}
